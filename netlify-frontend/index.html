<!--
===================
backend.js (Node.js + Express) ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á backend ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢
===================
const express = require('express');
const bodyParser = require('body-parser');
const stripe = require('stripe')(process.env.STRIPE_SECRET_KEY);
const app = express();
app.use(bodyParser.json());

let users = []; // ‡πÄ‡∏Å‡πá‡∏ö user (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
let orders = []; // ‡πÄ‡∏Å‡πá‡∏ö order (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)

app.post('/api/register', (req, res) => {
  const { username, email, password } = req.body;
  if(users.find(u => u.email === email)) return res.status(400).json({ error: 'Email ‡∏ã‡πâ‡∏≥' });
  users.push({ username, email, password });
  res.json({ success: true });
});

app.post('/api/login', (req, res) => {
  const { email, password } = req.body;
  const user = users.find(u => u.email === email && u.password === password);
  if(!user) return res.status(401).json({ error: '‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô' });
  res.json({ success: true, username: user.username });
});

app.post('/api/checkout', async (req, res) => {
  const { cart } = req.body;
  const line_items = cart.map(item => ({
    price_data: {
      currency: 'thb',
      product_data: {
        name: item,
      },
      unit_amount: 1000, // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ 10.00 THB
    },
    quantity: 1,
  }));

  const session = await stripe.checkout.sessions.create({
    payment_method_types: ['card'],
    line_items,
    mode: 'payment',
    success_url: 'http://localhost:3000/success.html',
    cancel_url: 'http://localhost:3000/cancel.html',
  });

  orders.push({ cart, sessionId: session.id });

  res.json({ url: session.url });
});

app.listen(3001, () => console.log('Backend running on port 3001'));
-->

<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Red & Black Web Shop (Demo)</title>
  <style>
    body {
      margin: 0; font-family: Arial, sans-serif;
      background: url('https://www.transparenttextures.com/patterns/black-linen.png') repeat,
        linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,0.9));
      background-blend-mode: overlay;
      color: white;
      padding-bottom: 100px;
    }
    header, footer {
      background-color: rgba(0,0,0,0.85);
      padding: 1rem;
      text-align: center;
    }
    nav a {
      margin: 0 1rem;
      color: red;
      text-decoration: none;
      font-weight: bold;
      cursor: pointer;
    }
    section {
      max-width: 900px;
      margin: 2rem auto;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 1rem 2rem;
      display: none;
    }
    section.active { display: block; }
    h2 { color: red; }
    button {
      background: red; color: black;
      padding: 0.5rem 1rem;
      border: none;
      margin-top: 0.5rem;
      cursor: pointer;
      border-radius: 5px;
    }
    input, textarea {
      padding: 0.5rem; border-radius: 5px;
      border: none; width: 100%;
      margin-top: 0.3rem;
      font-size: 1rem;
    }
    .product-card {
      background: rgba(255,255,255,0.15);
      margin: 1rem 0;
      padding: 1rem;
      border-radius: 10px;
    }
    ul { padding-left: 1rem; }
    #cart-list li {
      margin: 0.5rem 0;
    }
    #message {
      color: #ff6666;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>üî• Red & Black Shop (Demo) üî•</h1>
    <nav>
      <a onclick="showSection('home')">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
      <a onclick="showSection('products')">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
      <a onclick="showSection('cart')">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ (<span id="cart-count">0</span>)</a>
      <a onclick="showSection('login')">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
      <a onclick="showSection('register')">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
      <a onclick="showSection('contact')">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</a>
      <a id="logout-link" style="display:none;" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
    </nav>
  </header>

  <section id="home" class="active">
    <h2>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Red & Black Shop</h2>
    <p>‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ò‡∏µ‡∏°‡πÅ‡∏î‡∏á‡∏î‡∏≥ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ (Demo)</p>
  </section>

  <section id="products">
    <h2>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
      <select id ="category-filter" onchange="filterCategory(this.value)">
        <option value="‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        <option value="‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô">‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô</option>
        <option value="‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤">‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤</option>
      </select>
    </h2>
    <div id="product-list"></div>
  </section>

  <section id="cart">
    <h2>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
    <ul id="cart-list"><li>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</li></ul>
    <button onclick="checkout()" disabled id="checkout-btn">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
  </section>
  

  <section id="login">
    <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
    <form id="login-form">
      <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:<input type="email" id="login-email" required /></label>
      <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:<input type="password" id="login-password" required /></label>
      <button type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    </form>
    <p id="login-msg" style="color:red;"></p>
  </section>

  <section id="register">
    <h2>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
    <form id="register-form">
      <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:<input type="text" id="reg-username" required /></label>
      <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:<input type="email" id="reg-email" required /></label>
      <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:<input type="password" id="reg-password" required /></label>
      <button type="submit">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
    </form>
    <p id="register-msg" style="color:red;"></p>
  </section>

  <section id="contact">
    <h2>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h2>
    <form id="contact-form">
      <label>‡∏ä‡∏∑‡πà‡∏≠:<input type="text" id="contact-name" required /></label>
      <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:<input type="email" id="contact-email" required /></label>
      <label>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:<textarea id="contact-msg" rows="4" required></textarea></label>
      <button type="submit">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
    </form>
    <p id="contact-status" style="color:lime;"></p>
  </section>

  <footer>
    <p>&copy; 2025 Red & Black Web Shop | Demo Version</p>
  </footer>

  <script>
    // ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á backend (‡πÉ‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å server)
    let users = JSON.parse(localStorage.getItem('users') || '[]');
    let orders = JSON.parse(localStorage.getItem('orders') || '[]');
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');

    function logout() {
      currentUser = null;
      saveData();
      alert('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß');
      document.getElementById('login-msg').textContent = '';
      document.getElementById('logout-link').style.display = 'none';
      showSection('home');
    }

    function saveData() {
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('orders', JSON.stringify(orders));
      localStorage.setItem('cart', JSON.stringify(cart));
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
    }

    function showAdminPanel() {
      if (!currentUser || !currentUser.isAdmin) {
        alert("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà admin");
        return;
    }
    
    if (orders.length === 0){
      document.getElementById('admin-orders').innerHTML = '<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</p>';
      return;
    }

    const html = orders.map((order, i) => {
      return `<div style="margin-buttom:1rem;">
        <b>Order #${i + 1}</b><br/>
        ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${order.user}<br/>
        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date(order.date).toLocaleString()}<br/>
        ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: <ul>${order.cart.map(p => `<li>${p.name} - ‡∏ø${p.price}</li>`).join('')}<ul>
        ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ‡∏ø${order.total}
        </div>`;
      }).join('');

      document.getElementById('admin-orders').innerHTML = html;
    }

    function showSection(id) {
      document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      if(id === 'cart') updateCartUI();
      if(id === 'products') updateCartCount();
    }

    function updateCartCount() {
      document.getElementById('cart-count').textContent = cart.length;
    }

    function updateCartUI() {
      const list = document.getElementById('cart-list');
      if(cart.length === 0) {
        list.innerHTML = '<li>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</li>';
        document.getElementById('checkout-btn').disabled = true;
      } else {
        let total = 0;
        list.innerHTML = cart.map((item, i) => {
          total += item.price;
          return `<li>${item.name} - ‡∏ø${item.price}
            <button onclick="removeFromCart(${i})">‡∏•‡∏ö</button></li>`;
        }).join('');
        list.innerHTML += `<li><b>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ‡∏ø${total}</b></li>`;
        document.getElementById('checkout-btn').disabled = false;
      }
      updateCartCount();
    }

    function addToCart(product) {
      cart.push(product);
      saveData();
      alert(`${product.name} ‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤`);
      updateCartCount();
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      saveData();
      updateCartUI();
    }

    function showMyOrders() {
      showSection('my-orders');
      const myOrders = orders.filter(o => o.user === currentUser.email);
      if (myOrders.length === 0) {
        document.getElementById('my-order-list').innerHTML = '<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>';
        return
      }

      const html = myOrders.map((order, i) => {
        return `<div style="margin-bottom:1rem;">
          <b>Order #${i + 1}</b><br/>
          ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date (order.date).toLocaleString()}<br/>
          ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: <ul>${order.cart.map(p => `<li>${p.name} - ‡∏ø${p.price}</li>`).join('')}</ul>
          ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ‡∏ø${order.total}
        </dive>`;
      }).join('');

      document.getElementById('my-order-list').innerHTML = html;
    }

    //‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    const productData = [
      { name: '‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå', price: 120, category: '‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô' },
      { name: '‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•', price: 90, category: '‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô' },
      { name: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡πÅ‡∏î‡∏á', price: 120, category: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤' },
      { name: '‡∏´‡∏°‡∏ß‡∏Å‡∏î‡∏≥', price: 80, category: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤' }
    ];

    // ‡∏ü‡∏±‡∏á‡∏ä‡∏±‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
    function renderProducts(category = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î') {
      const list = document.getElementById('product-list');
      const filtered = category === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'
        ? productData
        : productData.filter(p => p.category === category);

      list.innerHTML = filtered.map(p => `
      <div class="product-card">
        <h3>${p.name}</h3>
        <p>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: ${p.category}</p>
        <p>‡∏£‡∏≤‡∏Ñ‡∏≤: ‡∏ø${p.price}</p>
        <button onclick="addToCart(${JSON.stringify(p).replace(/"/g, '&quot;')})">‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
      </div>
      `).join('');
    }

    //‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
    function filterCategory(cat) {
      renderProducts(cat);
    }
    // ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
    document.getElementById('register-form').addEventListener('submit', e => {
      e.preventDefault();
      const username = document.getElementById('reg-username').value.trim();
      const email = document.getElementById('reg-email').value.trim();
      const password = document.getElementById('reg-password').value;
      const msg = document.getElementById('register-msg');

      if(users.find(u => u.email === email)) {
        msg.textContent = '‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß';
        return;
      }

      users.push({ username, email, password, isAdmin: email === 'phoomdet.phetsuwan.mail@gmail.com' });
      saveData();
      msg.style.color = 'lime';
      msg.textContent = '‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö';
      document.getElementById('register-form').reset();

      if (user.isAdmin && !document.querySelector('nav a.admin-link')) {
  const adminLink = document.createElement('a');
  adminLink.textContent = '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö';
  adminLink.classList.add('admin-link');
  adminLink.onclick = showAdminPanel;
  document.querySelector('nav').appendChild(adminLink);
}

    });

    // ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
    document.getElementById('login-form').addEventListener('submit', e => {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const msg = document.getElementById('login-msg');

      const user = users.find(u => u.email === email && u.password === password);
      if(!user) {
        msg.textContent = '‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
        return;
      }

      if (currentUser && !currentUser.isAdmin) {
        const orderLink = document.createElement('a');
        orderLink.textContent = '‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô';
        orderLink.onclick = showMyOrders;
        document.querySelector('nav').appendChild(orderLink);
      }
      currentUser = user;
      saveData();
      document.getElementById('logout-link').style.display = 'inline'; // ‚ûï ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° logout
      msg.style.color = 'lime';
      msg.textContent = `‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, ${user.username}`;
      document.getElementById('login-form').reset();
      showSection('home');

    });

    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
    document.getElementById('contact-form').addEventListener('submit', e => {
      e.preventDefault();
      const name = document.getElementById('contact-name').value.trim();
      const email = document.getElementById('contact-email').value.trim();
      const message = document.getElementById('contact-msg').value.trim();
      const status = document.getElementById('contact-status');

      // ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ backend ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•
      status.textContent = '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤!';
      document.getElementById('contact-form').reset();
    });

    // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡∏≤‡∏ó‡πå (‡∏à‡∏≥‡∏•‡∏≠‡∏á) - ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° API ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á
    async function checkout() {
  if (!currentUser) {
    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô');
    showSection('login');
    return;
  }

  if (cart.length === 0) {
    alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤');
    return;
  }

  try {
    const res = await fetch('http://localhost:3001/api/checkout', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ cart })
    });

    const data = await res.json();

    if (data.url) {
      window.location.href = data.url; // üëâ ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Stripe Checkout ‡∏à‡∏£‡∏¥‡∏á
    } else {
      alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô');
    }
  } catch (err) {
    console.error(err);
    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå');
  }
}


    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
    window.onload = () => {
      updateCartCount();
      renderProducts();
      if(currentUser) {
        document.getElementById('login-msg').style.color = 'lime';
        document.getElementById('login-msg').textContent = `‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, ${currentUser.username}`;
        document.getElementById('logout-link').style.display = 'inline';

        document.querySelector("nav a[onclick=\"showSection('login')\"]").style.display = 'none';
        document.querySelector("nav a[onclick=\"showSection('register')\"]").style.display = 'none';
        document.querySelector("nav a[onclick=\"showSection('login')\"]").style.display = 'inline';
        document.querySelector("nav a[onclick=\"showSection('register')\"]").style.display = 'inline';
      }

      if (currentUser.isAdmin && !document.querySelector('nav a.admin-link')) {
        const adminLink = document.createElement('a');
        adminLink.textContent = '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö';
        adminLink.classList.add('admin-link');
        adminLink.onclick = showAdminPanel;
        document.querySelector('nav').appendChild(adminLink);
      }
    }
  </script>
</body>
<section id="admin-panel">
  <h2>Admin Panel</h2>
  <div id="admin-orders"></div>
  <section id="my-orders">
    <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
    <div id="my-order-list"></div>
  </section>
</html>
